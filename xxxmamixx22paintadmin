-- Settings
local color = Color3.fromRGB(255,255,255)

-- Services
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local player = game.Players.LocalPlayer
local mouse = player:GetMouse()

-- Folders & Highlights
local provincesFolder = Instance.new("Model")
provincesFolder.Parent = workspace

local highlight = Instance.new("Highlight")
highlight.FillColor = color
highlight.FillTransparency = 0.8
highlight.Parent = workspace
highlight.Adornee = provincesFolder

-- UI
local UI = Instance.new("ScreenGui", player.PlayerGui)
local UIHolder = Instance.new("Frame", UI)
UIHolder.AnchorPoint = Vector2.new(0.5,0.5)
UIHolder.BackgroundTransparency = 1
UIHolder.Position = UDim2.new(0.5,0,0.5,0)
UIHolder.Size = UDim2.new(0,0,0,0)
local aspectratio = Instance.new("UIAspectRatioConstraint", UIHolder)

local mainFrame = Instance.new("Frame", UIHolder)
mainFrame.BackgroundColor3 = Color3.fromRGB(33,33,42)
mainFrame.AnchorPoint = Vector2.new(0.5,0.5)
mainFrame.Position = UDim2.new(0.5,0,0.5,0)
mainFrame.Size = UDim2.new(0.5,0,0.276,0)
mainFrame.Rotation = 359

local topBar = Instance.new("Frame", mainFrame)
topBar.BorderColor3 = Color3.fromRGB(0,0,0)
topBar.BackgroundColor3 = Color3.fromRGB(49,49,64)
topBar.Size = UDim2.new(1,0,0.14,0)

-- Panel Title
local panelTitle = Instance.new("TextLabel", topBar)
panelTitle.AnchorPoint = Vector2.new(0,0.5)
panelTitle.BackgroundTransparency = 1
panelTitle.Position = UDim2.new(0.02,0,0.5,0)
panelTitle.Size = UDim2.new(1,0,0.5,0)
panelTitle.Text = '<b>Paint Admin Panel</b><font size="6"> PRO</font>'
panelTitle.RichText = true
panelTitle.TextScaled = true
panelTitle.TextColor3 = Color3.fromRGB(255,255,255)
panelTitle.TextXAlignment = Enum.TextXAlignment.Left

-- Close button (X)
local closeButton = Instance.new("TextButton", topBar)
closeButton.AnchorPoint = Vector2.new(1,0.5)
closeButton.Position = UDim2.new(0.98,0,0.5,0)
closeButton.Size = UDim2.new(0.08,0,0.7,0)
closeButton.Text = "X"
closeButton.TextScaled = true
closeButton.BackgroundColor3 = Color3.fromRGB(200,50,50)
closeButton.TextColor3 = Color3.fromRGB(255,255,255)
closeButton.BorderSizePixel = 0
closeButton.MouseButton1Click:Connect(function()
    UIHolder.Visible = false
end)

-- Paint counter
local pss = Instance.new("TextLabel", topBar)
pss.Text = "0 paint/second | Total: 0"
pss.AnchorPoint = Vector2.new(0,0.5)
pss.Size = UDim2.new(0.974,0,0.5,0)
pss.Position = UDim2.new(0,0,0.5,0)
pss.TextColor3 = Color3.fromRGB(255,255,255)
pss.BackgroundTransparency = 1
pss.TextScaled = true
pss.TextXAlignment = Enum.TextXAlignment.Right

-- ScrollFrame
local scrollFrame = Instance.new("ScrollingFrame", mainFrame)
scrollFrame.BackgroundTransparency = 1
scrollFrame.Position = UDim2.new(0,0,0.14,0)
scrollFrame.Size = UDim2.new(1,0,0.86,0)
scrollFrame.ScrollBarThickness = 0

local listlayout = Instance.new("UIListLayout", scrollFrame)
listlayout.Padding = UDim.new(0,10)
local uipadding = Instance.new("UIPadding", scrollFrame)
uipadding.PaddingTop = UDim.new(0,10)
uipadding.PaddingLeft = UDim.new(0,10)
uipadding.PaddingRight = UDim.new(0,10)
uipadding.PaddingBottom = UDim.new(0,10)

-- Done Button
local doneButton = Instance.new("TextButton", UI)
doneButton.Visible = false
doneButton.AnchorPoint = Vector2.new(0.5,0)
doneButton.BackgroundColor3 = Color3.fromRGB(0,247,159)
doneButton.Position = UDim2.new(0.5,0,0,0)
doneButton.Size = UDim2.new(0.3,0,0.1,0)
doneButton.TextColor3 = Color3.fromRGB(255,255,255)
doneButton.TextScaled = true
doneButton.Text = "Done"
doneButton.AutoButtonColor = false
doneButton.BorderSizePixel = 0

-- White frame
local whiteFrame = Instance.new("Frame", mainFrame)
whiteFrame.Size = UDim2.new(1,0,1,0)
whiteFrame.BackgroundColor3 = Color3.fromRGB(255,255,255)

-- Sounds
local sound = Instance.new("Sound", workspace)
sound.SoundId = "rbxassetid://4612386227"
local changecolor = Instance.new("Sound", workspace)
changecolor.SoundId = "rbxassetid://4612383790"
local sound2 = Instance.new("Sound", workspace)
sound2.SoundId = "rbxassetid://7486747911"
sound2.PlaybackSpeed = 2
local provinceSound = Instance.new("Sound", workspace)
provinceSound.SoundId = "rbxassetid://5694665239"

-- Variables
local provinces = {}
local provincespersecond = 0
local totalPainted = 0
local pps = 0
local selectColorMode = false
local removeProvincesMode = false
local selectProvincesMode = false
local safeMode = false
local newpaint = false
local painting = true
local keepTerColor = false
local provinceCodeGenerator = 0

-- Drag variables
local dragging
local dragInput
local dragStart
local startPos

-- Functions
local function paintProvinceLoop(province, coro, highlighty)
    local savedColor = color
    local running = true

    task.spawn(function()
        while running and painting do
            if player.Character and player.Character:FindFirstChild("PaintBucket") then
                local targetColor = keepTerColor and savedColor or color
                if province.Color ~= targetColor then
                    local args = {
                        [1] = "PaintPart",
                        [2] = {["Part"] = province, ["Color"] = targetColor},
                        [3] = "Peace"
                    }
                    player.Character.PaintBucket.Remotes.ServerControls:InvokeServer(unpack(args))
                    provincespersecond += 1
                    totalPainted += 1
                end
            end

            if safeMode then
                task.wait(0.2)
            elseif newpaint then
                task.wait(0.05)
            else
                task.wait(0.1)
            end
        end
    end)

    local provinceInfo = {
        ["Province"] = province,
        ["Coroutine"] = coro,
        ["Stop"] = function() running = false end,
        ["Highlight"] = highlighty
    }
    table.insert(provinces, provinceInfo)
    provinceCodeGenerator += 1
end

-- Dragging function
local function update(input)
    local delta = input.Position - dragStart
    mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

-- UI Animations
wait(1)
sound:Play()
if UserInputService.MouseEnabled == false then
    TweenService:Create(UIHolder, TweenInfo.new(0.5), {Size = UDim2.new(1.5,0,1.5,0)}):Play()
else
    TweenService:Create(UIHolder, TweenInfo.new(0.5), {Size = UDim2.new(0.75,0,0.75,0)}):Play()
end
TweenService:Create(mainFrame, TweenInfo.new(0.5), {Rotation = 0}):Play()
TweenService:Create(whiteFrame, TweenInfo.new(4), {BackgroundTransparency = 1}):Play()

-- Dragging
topBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

topBar.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
        dragInput = input
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        update(input)
    end
end)

-- FPS bağımsız sayaç
task.spawn(function()
    while task.wait(1) do
        pss.TextColor3 = Color3.fromRGB(80, 255, 123)
        if provincespersecond >= 50 then pss.TextColor3 = Color3.fromRGB(247, 226, 112) end
        if provincespersecond >= 100 then pss.TextColor3 = Color3.fromRGB(245, 128, 37) end
        if provincespersecond >= 300 then pss.TextColor3 = Color3.fromRGB(235, 8, 10) end
        if provincespersecond >= 1000 then pss.TextColor3 = Color3.fromRGB(235, 0, 120) end

        pss.Text = provincespersecond.." paint/second | Total: "..totalPainted
        provincespersecond = 0
    end
end)
