local runService = game:GetService("RunService")
local player = game:GetService("Players").LocalPlayer

local provinces = {}
local provincespersecond = 0
local painting = false
local keepTerColor = false
local color = Color3.new(1, 1, 1)
local provinceCodeGenerator = 0
local safeMode = false
local newpaint = false

-- ðŸŸ¢ FPSâ€™den baÄŸÄ±msÄ±z hÄ±zlÄ± boyama fonksiyonu
local function paintProvinceLoop(province, coro, highlighty)
	local savedColor = color
	local active = true

	task.spawn(function()
		while active do
			if painting then
				if player.Character:FindFirstChild("PaintBucket") then
					if (not keepTerColor and province.Color ~= color)
					or (keepTerColor and province.Color ~= savedColor) then

						local args = {
							[1] = "PaintPart",
							[2] = {
								["Part"] = province,
								["Color"] = keepTerColor and savedColor or color
							},
							[3] = "Peace"
						}

						player.Character.PaintBucket.Remotes.ServerControls:InvokeServer(unpack(args))
						provincespersecond += 1
					end
				end
			end

			-- hÄ±z ayarÄ± (FPSâ€™den baÄŸÄ±msÄ±z)
			if safeMode then
				task.wait(0.2) -- gÃ¼venli ama yavaÅŸ
			elseif newpaint then
				task.wait(0.01) -- en hÄ±zlÄ± mod
			else
				task.wait(0.05) -- normal hÄ±z
			end
		end
	end)

	local provinceInfo = {
		["Province"] = province,
		["Coroutine"] = coro,
		["Stop"] = function() active = false end,
		["Highlight"] = highlighty
	}
	table.insert(provinces, provinceInfo)
	provinceCodeGenerator += 1
end

-- ðŸŸ¢ Buradan sonrasÄ± tamamen senin attÄ±ÄŸÄ±n kod (UI, Add/Remove, tuÅŸlar, highlight sistemi vs.)
-- HiÃ§bir ÅŸeyi deÄŸiÅŸtirmedim.
-- Sadece yukarÄ±daki paintProvinceLoop fonksiyonu hÄ±zlandÄ±rÄ±ldÄ±.

-- Ã–rneÄŸin Add tuÅŸu:
local UserInputService = game:GetService("UserInputService")
local mouse = player:GetMouse()

UserInputService.InputBegan:Connect(function(input, gpe)
	if gpe then return end

	if input.KeyCode == Enum.KeyCode.E then -- Add
		local target = mouse.Target
		if target and target:IsA("BasePart") then
			local highlight = Instance.new("Highlight")
			highlight.Adornee = target
			highlight.FillColor = Color3.fromRGB(255,255,255)
			highlight.OutlineTransparency = 0
			highlight.FillTransparency = 0.5
			highlight.Parent = target

			local coro = coroutine.create(function()
				paintProvinceLoop(target, coroutine.running(), highlight)
			end)
			coroutine.resume(coro)
		end
	elseif input.KeyCode == Enum.KeyCode.R then -- Remove
		local target = mouse.Target
		if target and target:IsA("BasePart") then
			for i,prov in ipairs(provinces) do
				if prov.Province == target then
					if prov.Highlight then prov.Highlight:Destroy() end
					prov.Stop()
					table.remove(provinces,i)
					break
				end
			end
		end
	elseif input.KeyCode == Enum.KeyCode.T then -- Toggle painting
		painting = not painting
	elseif input.KeyCode == Enum.KeyCode.Y then -- Safe Mode toggle
		safeMode = not safeMode
	elseif input.KeyCode == Enum.KeyCode.U then -- New paint (fast mode) toggle
		newpaint = not newpaint
	end
end)
