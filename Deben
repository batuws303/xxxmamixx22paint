-- Settings --
local color = Color3.fromRGB(255,255,255)

-- Services --
local userInputService = game:GetService("UserInputService")
local runService = game:GetService("RunService")
local tweenService = game:GetService("TweenService")
local player = game.Players.LocalPlayer
local mouse = player:GetMouse()

-- UI ve highlight kısmı orijinal script gibi kalacak
-- [UI ve highlight kodları burada aynen kalacak]  

-- Provinces ve paint değerleri
local provinces = {}
local provincespersecond = 0
local pps = 0

local selectColorMode = false
local removeProvincesMode = false
local selectProvincesMode = false
local safeMode = false
local newpaint = false
local painting = true
local keepTerColor = false

local provinceCodeGenerator = 0

-- Boyama mantığı
local function paintProvince(province, savedColor)
    if not province then return end
    if not player.Character:FindFirstChild("PaintBucket") then return end

    -- Boyama döngüsü
    coroutine.wrap(function()
        while painting do
            if province.Color ~= color then
                local args = {
                    [1] = "PaintPart",
                    [2] = {
                        ["Part"] = province,
                        ["Color"] = keepTerColor and savedColor or color
                    },
                    [3] = "Peace"
                }
                game:GetService("Players").LocalPlayer.Character.PaintBucket.Remotes.ServerControls:InvokeServer(unpack(args))
                provincespersecond = provincespersecond + 1
            end
            -- FPS düşüşünü telafi etmek için wait kısa ve sabit
            if safeMode then
                wait(0.2)
            elseif newpaint then
                wait(0)
            else
                wait(0.05)
            end

            -- Eğer renk değiştiyse veya boyama tamamlandıysa döngüyü bitir
            if province.Color == color or not painting then
                break
            end
        end
    end)()
end

-- Mouse tıklama eventi
mouse.Button1Down:Connect(function()
    if mouse.Target and mouse.Target.Name == "Province" then
        local savedColor = mouse.Target.Color

        if selectColorMode then
            color = mouse.Target.Color
            selectColorMode = false
            UIHolder.Visible = true
            button2.BackgroundColor3 = color
        end

        if selectProvincesMode then
            provinceSound:Play()
            local clone = mouse.Target:Clone()
            clone.Position -= Vector3.new(0,0.01,0)
            clone.Material = "Glass"
            clone.Transparency = 1
            clone.Parent = provincesFolder

            paintProvince(mouse.Target, savedColor)
        end

        if removeProvincesMode then
            for _, info in pairs(provinces) do
                if mouse.Target == info.Province then
                    coroutine.close(info.Coroutine)
                    info.Event:Disconnect()
                    info.Highlight:Destroy()
                end
            end
        end
    end
end)

-- Paint/second göstergesi
runService.RenderStepped:Connect(function()
    pss.Text = provincespersecond.." paint/second"
    provincespersecond = 0
end)

-- Toggle switchleri ve UI eventleri orijinal scriptteki gibi çalışacak
-- [UI butonları ve toggle kodları burada orijinal gibi kalacak]
